{% extends "student/base.html.twig" %}

{% block pageContent %}
    {% if needsSetup %}
        {{ include('student/chat/_setup_modal.html.twig') }}
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const setupModal = new bootstrap.Modal(document.getElementById('setupModal'));
                setupModal.show();
            });
        </script>
    {% else %}
        <!-- Include the forum grid -->
        <div class="h-screen flex flex-col">
            {{ include('student/chat/forum/_grid.html.twig', {
                forums: forums,
                categories: categories
            }) }}
        </div>
    {% endif %}
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <!-- Add Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00a884;
            --primary-foreground: #ffffff;
            --secondary: #f0f2f5;
            --secondary-foreground: #111b21;
            --muted: #667781;
            --muted-foreground: #8696a0;
            --background: #ffffff;
            --foreground: #111b21;
            --border: #e9edef;
            --radius: 0.5rem;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background-color: var(--background);
            color: var(--foreground);
        }

        .bg-primary {
            background-color: var(--primary) !important;
        }

        .text-primary {
            color: var(--primary) !important;
        }

        .bg-secondary {
            background-color: var(--secondary) !important;
        }

        .text-muted {
            color: var(--muted) !important;
        }

        .border-color {
            border-color: var(--border) !important;
        }

        /* Additional styles for the chat interface */
        .page-content {
            background-color: var(--bs-light);
            min-height: calc(100vh - 70px); /* Adjust based on your header height */
            padding: 1.5rem;
        }
    </style>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('assets/js/chat/websocket.js') }}"></script>
    <script>
        // Initialize WebSocket configuration
        window.WS_CONFIG = {
            reconnectAttempts: 5,
            reconnectDelay: 3000,
            messageQueueSize: 100
        };
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize tooltips
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
        });
    </script>
{% endblock %}
